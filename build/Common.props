<?xml version="1.0" encoding="utf-8"?>
<Project>

  <!-- Default settings for basic package information. -->
  <PropertyGroup>
    <PackageCopyrightYears Condition=" '$(PackageCopyrightYears)' == '' ">$([System.DateTime]::UtcNow.Year)</PackageCopyrightYears>
  </PropertyGroup>

  <!-- Basic package information. -->
  <PropertyGroup>
    <Authors>Zastai</Authors>
    <Company>MetaBrainz</Company>
    <Copyright>Copyright Â© $(PackageCopyrightYears) Tim Van Holder. All rights reserved.</Copyright>
    <PackageLicenseExpression>MS-PL</PackageLicenseExpression>
    <RepositoryType>Github</RepositoryType>
  </PropertyGroup>

  <!-- C# Configuration -->
  <PropertyGroup>
    <LangVersion>8</LangVersion>
    <Nullable>disable</Nullable>
  </PropertyGroup>

  <!-- Ensure this has a default, because we use it below. -->
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
  </PropertyGroup>

  <!-- This sets up builds of all projects to place build output under a single root location within the solution. -->
  <PropertyGroup>
    <BuildOutputRoot>$([MSBuild]::NormalizeDirectory('$(MSBuildThisFileDirectory)', '..', 'output'))</BuildOutputRoot>
    <IntermediateRoot>$([MSBuild]::NormalizeDirectory('$(BuildOutputRoot)', 'obj', '$(MSBuildProjectName)'))</IntermediateRoot>
    <MainOutputRoot>$([MSBuild]::NormalizeDirectory('$(BuildOutputRoot)', 'bin', '$(MSBuildProjectName)'))</MainOutputRoot>
    <BaseIntermediateOutputPath>$(IntermediateRoot)</BaseIntermediateOutputPath>
    <IntermediateOutputPath>$([MSBuild]::NormalizeDirectory('$(IntermediateRoot)', '$(Configuration)'))</IntermediateOutputPath>
    <OutputPath>$([MSBuild]::NormalizeDirectory('$(MainOutputRoot)', '$(Configuration)'))</OutputPath>
    <PackageOutputPath>$([MSBuild]::NormalizeDirectory('$(BuildOutputRoot)', 'package', '$(Configuration)'))</PackageOutputPath>
  </PropertyGroup>

  <!-- Always create strong-named assemblies. -->
  <PropertyGroup>
    <AssemblyOriginatorKeyFile>$([MSBuild]::NormalizePath('$(MSBuildThisFileDirectory)', 'MetaBrainz.snk'))</AssemblyOriginatorKeyFile>
    <SignAssembly>true</SignAssembly>
  </PropertyGroup>

  <!-- When making a NuGet package, also make a symbols package. -->
  <PropertyGroup>
    <IncludeSymbols>true</IncludeSymbols>
    <SymbolPackageFormat>snupkg</SymbolPackageFormat>
  </PropertyGroup>

  <!-- Release Builds: Create a package, and disallow warnings. -->
  <PropertyGroup Condition=" '$(Configuration)' == 'Release' ">
    <GeneratePackageOnBuild>True</GeneratePackageOnBuild>
    <TreatWarningsAsErrors>True</TreatWarningsAsErrors>
  </PropertyGroup>

  <!-- Various Other Settings -->
  <PropertyGroup>
    <RestoreProjectStyle>PackageReference</RestoreProjectStyle>
  </PropertyGroup>

  <!-- Enable targeting the .NET Framework using only the .NET Core SDK. -->
  <ItemGroup>
    <PackageReference Include="Microsoft.NETFramework.ReferenceAssemblies" Version="1.0.0">
      <PrivateAssets>all</PrivateAssets>
      <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
    </PackageReference>
  </ItemGroup>

  <!-- The building Visual Studio's major version; 0 if not available. -->
  <PropertyGroup>
    <BuildVSVersion>0</BuildVSVersion>
    <BuildVSVersion Condition=" $(VisualStudioVersion) != '' ">$([System.Version]::Parse($(VisualStudioVersion)).Major)</BuildVSVersion>
  </PropertyGroup>

  <!-- Some of our targets include debug output. Default it to low importance. -->
  <PropertyGroup>
    <DebugMessageImportance Condition=" '$(DebugMessageImportance)' == '' ">Low</DebugMessageImportance>
  </PropertyGroup>

</Project>
